import java.util.*;

public class Day20 {

    public static int cheat2(String input) {
        char[][] grid = parseGrid(input);

        HashMap<Coord, Integer> dists = shortest(grid);

        int count = 0;

        Set<Cheat> cheats = new HashSet<Cheat>();

        for (Coord key : dists.keySet()) {
            for (int i = key.getX() - 20; i <= key.getX() + 20; i++) {
                for (int j = key.getY() - 20; j <= key.getY() + 20; j++) {
                    Coord s = new Coord(i, j);
                    if (valid(s, grid)) {
                       //Calculate the Manhattan Distance
                       int mdist = Math.abs(s.getX() - key.getX()) + Math.abs(s.getY() - key.getY());

                       if (mdist <= 20) {
                           if (dists.get(s) - (dists.get(key) + mdist) >= 100) {
                               Cheat c = new Cheat(key, s);
                               cheats.add(c);
                           }
                       }
                    }

                }
            }

        }



        return cheats.size();
    }



    public static int cheats(String input) {
        char[][] grid = parseGrid(input);

        HashMap<Coord, Integer> dists = shortest(grid);

        int count = 0;

        for (Coord key : dists.keySet()) {
            //test up
            if (grid[key.getX() - 1][key.getY()] == '#') {
                Coord s = new Coord(key.getX() - 2, key.getY());

                if (valid(s, grid)) {
                    if (dists.get(s) - (dists.get(key) + 2) >= 100) {
                        count = count + 1;
                    }
                }
            }

            //test right
            if (grid[key.getX()][key.getY() + 1] == '#') {
                Coord s = new Coord(key.getX(), key.getY() + 2);

                if (valid(s, grid)) {
                    if (dists.get(s) - (dists.get(key) + 2) >= 100) {
                        count = count + 1;
                    }
                }
            }

            //test down
            if (grid[key.getX() + 1][key.getY()] == '#') {
                Coord s = new Coord(key.getX() + 2, key.getY());

                if (valid(s, grid)) {
                    if (dists.get(s) - (dists.get(key) + 2) >= 100) {
                        count = count + 1;
                    }
                }
            }

            //test left
            if (grid[key.getX()][key.getY() - 1] == '#') {
                Coord s = new Coord(key.getX(), key.getY() - 2);

                if (valid(s, grid)) {
                    if (dists.get(s) - (dists.get(key) + 2) >= 100) {
                        count = count + 1;
                    }
                }
            }
        }




        return count;
    }

    //basic implementation of dijstras algorithm
    public static HashMap<Coord, Integer> shortest(char[][] grid) {
        Coord start = findStart(grid);

        PriorityQueue<Pair> pq = new PriorityQueue<Pair>();

        HashMap<Coord, Integer> dists = new HashMap<Coord, Integer>();

        Pair p = new Pair(0, start);

        pq.add(p);

        while (!pq.isEmpty()) {
            Pair w = pq.poll();

            Coord curr = w.getPoint();

            ArrayList<Coord> adj = adjacent(curr, grid);

            for (Coord c : adj) {
                if (w.getDistance() + 1 < dists.getOrDefault(c, Integer.MAX_VALUE)) {
                    dists.put(c, w.getDistance() + 1);
                    Pair n = new Pair(w.getDistance() + 1, c);
                    pq.add(n);
                }
            }

        }

        return dists;
    }

    public static ArrayList<Coord> adjacent(Coord current, char[][] grid) {
        ArrayList<Coord> adj = new ArrayList<Coord>();

        Coord up = new Coord(current.getX() - 1, current.getY());

        if (valid(up, grid)) {
            adj.add(up);
        }

        Coord right = new Coord(current.getX(), current.getY() + 1);

        if (valid(right, grid)) {
            adj.add(right);
        }

        Coord down = new Coord(current.getX() + 1, current.getY());

        if (valid(down, grid)) {
            adj.add(down);
        }

        Coord left = new Coord(current.getX(), current.getY() - 1);

        if (valid(left, grid)) {
            adj.add(left);
        }

        return adj;
    }

    public static boolean valid(Coord current, char[][] grid) {
        return current.getX() >= 0 && current.getY() >= 0 && current.getX() < grid.length && current.getY() < grid[0].length && grid[current.getX()][current.getY()] != '#';
    }




    public static Coord findEnd(char[][] grid) {

        for (int i = 0; i < grid.length; i++) {
            for (int j = 0; j < grid[0].length; j++) {
                if (grid[i][j] == 'E') {
                    Coord c = new Coord(i, j);

                    return c;
                }
            }
        }

        return null;

    }


    public static Coord findStart(char[][] grid) {

        for (int i = 0; i < grid.length; i++) {
            for (int j = 0; j < grid[0].length; j++) {
                if (grid[i][j] == 'S') {
                    Coord c = new Coord(i, j);

                    return c;
                }
            }
        }

        return null;

    }


    public static class Cheat {
        Coord start;

        Coord end;

        public Cheat(Coord start, Coord end) {
            this.start = start;
            this.end = end;
        }

        @Override
        public int hashCode() {
            return 31*(start.hashCode()) + end.hashCode();
        }

        @Override
        public boolean equals(Object obj) {
            try {
                Cheat c = (Cheat) obj;

                return c.start.equals(this.start) && c.end.equals(this.end);
            } catch (ClassCastException e) {
                return false;
            }
        }
    }

    public static class Pair implements Comparable<Pair> {

        private int distance;

        private Coord point;

        public Pair(int distance, Coord point) {
            this.distance = distance;
            this.point = point;
        }

        public int getDistance() {
            return distance;
        }

        public Coord getPoint() {
            return point;
        }

        @Override
        public int compareTo(Pair o) {
            if (this.distance < o.distance) {
                return -1;
            } else if (this.distance == o.distance) {
                return 0;
            } else {
                return 1;
            }
        }
    }



    public static class Coord {
        private final int x;

        private final int y;

        public Coord(int x, int y) {
            this.x = x;
            this.y = y;
        }

        public int getX() {
            return x;
        }

        public int getY() {
            return y;
        }

        @Override
        public boolean equals(Object obj) {
            try {
                Coord c = (Coord) obj;

                return this.getX() == c.getX() && this.getY() == c.getY();
            } catch (ClassCastException e) {
                return false;
            }
        }

        @Override
        public int hashCode() {
            return 31*x + y;
        }

        @Override
        public String toString() {
            return "(" + x +"," + y + ")";
        }
    }


    public static char[][] parseGrid(String input) {
        String[] s = input.split("\n");

        char[][] grid = new char[s.length][s[0].length()];

        for (int i = 0; i < s.length; i++) {
            String row = s[i];
            for (int j = 0; j < row.length(); j++) {
                grid[i][j] = row.charAt(j);
            }
        }

        return grid;
    }




    public static void main(String[] args) {
        String input = "#############################################################################################################################################\n" +
                "#.....###.......#...###.....#...#.......#...#.....###.....#.......#...#.......#...#...#...#...#...#.....................#.....###.......#...#\n" +
                "#.###.###.#####.#.#.###.###.#.#.#.#####.#.#.#.###.###.###.#.#####.#.#.#.#####.#.#.#.#.#.#.#.#.#.#.#.###################.#.###.###.#####.#.#.#\n" +
                "#...#...#.....#...#...#...#...#.#.....#...#...#...#...#...#...#...#.#.#...#...#.#...#...#.#.#.#.#.#.#...................#.#...#...#.....#.#.#\n" +
                "###.###.#####.#######.###.#####.#####.#########.###.###.#####.#.###.#.###.#.###.#########.#.#.#.#.#.#.###################.#.###.###.#####.#.#\n" +
                "#...#...#...#.#.......###...#...#.....#.........###...#...#...#...#.#.#...#...#.....#.....#.#.#.#...#.....#...#...#...#...#...#...#.#...#.#.#\n" +
                "#.###.###.#.#.#.###########.#.###.#####.#############.###.#.#####.#.#.#.#####.#####.#.#####.#.#.#########.#.#.#.#.#.#.#.#####.###.#.#.#.#.#.#\n" +
                "#...#.....#...#.#.....#.....#...#.....#.###...#.....#...#.#.#...#.#.#.#.....#.#...#.#.#.....#.#.#.........#.#.#.#...#.#.#.....#...#...#.#.#.#\n" +
                "###.###########.#.###.#.#######.#####.#.###.#.#.###.###.#.#.#.#.#.#.#.#####.#.#.#.#.#.#.#####.#.#.#########.#.#.#####.#.#.#####.#######.#.#.#\n" +
                "###...#.......#.#...#.#...#.....###...#...#.#.#.#...#...#.#.#.#...#.#...#...#.#.#.#.#.#.....#.#.#...#...###.#.#.#.....#.#.......#.......#.#.#\n" +
                "#####.#.#####.#.###.#.###.#.#######.#####.#.#.#.#.###.###.#.#.#####.###.#.###.#.#.#.#.#####.#.#.###.#.#.###.#.#.#.#####.#########.#######.#.#\n" +
                "#...#...#.....#.#...#...#.#...#...#.....#.#.#.#.#.#...#...#.#...#...#...#...#.#.#.#.#.....#.#.#...#.#.#.#...#...#...###.#.........#...###.#.#\n" +
                "#.#.#####.#####.#.#####.#.###.#.#.#####.#.#.#.#.#.#.###.###.###.#.###.#####.#.#.#.#.#####.#.#.###.#.#.#.#.#########.###.#.#########.#.###.#.#\n" +
                "#.#.#...#...#...#...#...#...#.#.#.#...#.#.#.#...#.#...#.#...#...#...#.....#.#.#.#.#.#.....#.#.#...#...#.#.#.......#.....#...#...###.#...#.#.#\n" +
                "#.#.#.#.###.#.#####.#.#####.#.#.#.#.#.#.#.#.#####.###.#.#.###.#####.#####.#.#.#.#.#.#.#####.#.#.#######.#.#.#####.#########.#.#.###.###.#.#.#\n" +
                "#.#...#.###.#.#...#.#...###.#.#.#.#.#.#.#...#.....###.#.#...#.....#.....#.#.#.#.#.#.#...#...#...#...#...#...###...#...#...#...#.#...#...#.#.#\n" +
                "#.#####.###.#.#.#.#.###.###.#.#.#.#.#.#.#####.#######.#.###.#####.#####.#.#.#.#.#.#.###.#.#######.#.#.#########.###.#.#.#.#####.#.###.###.#.#\n" +
                "#.....#.#...#.#.#...#...#...#.#.#.#.#.#.....#...###...#.#...#.....#.....#...#...#.#.#...#.......#.#...#...###...#...#...#.......#.#...#...#.#\n" +
                "#####.#.#.###.#.#####.###.###.#.#.#.#.#####.###.###.###.#.###.#####.#############.#.#.#########.#.#####.#.###.###.###############.#.###.###.#\n" +
                "#...#.#.#...#.#.....#...#...#...#.#.#...#...#...#...#...#...#...#...#...#...#.....#.#.#...###...#.#...#.#.#...#...#...###...#...#.#.....#...#\n" +
                "#.#.#.#.###.#.#####.###.###.#####.#.###.#.###.###.###.#####.###.#.###.#.#.#.#.#####.#.#.#.###.###.#.#.#.#.#.###.###.#.###.#.#.#.#.#######.###\n" +
                "#.#.#.#.....#...###...#...#.....#...#...#.#...###...#.#...#.#...#.....#...#.#...#...#.#.#.#...#...#.#...#.#...#.....#.#...#...#.#.#.......###\n" +
                "#.#.#.#########.#####.###.#####.#####.###.#.#######.#.#.#.#.#.#############.###.#.###.#.#.#.###.###.#####.###.#######.#.#######.#.#.#########\n" +
                "#.#.#.......#...#...#...#.###...#.....#...#.#.......#...#...#...........#...#...#.#...#.#.#...#.#...#.....#...#.......#.#.......#.#.........#\n" +
                "#.#.#######.#.###.#.###.#.###.###.#####.###.#.#########################.#.###.###.#.###.#.###.#.#.###.#####.###.#######.#.#######.#########.#\n" +
                "#.#.#.......#...#.#.#...#...#...#.#...#...#.#.......#.......#...#.......#...#...#.#.###.#.....#.#.#...#...#...#.........#.#.....#.#.........#\n" +
                "#.#.#.#########.#.#.#.#####.###.#.#.#.###.#.#######.#.#####.#.#.#.#########.###.#.#.###.#######.#.#.###.#.###.###########.#.###.#.#.#########\n" +
                "#.#...#...#...#...#.#.....#.#...#.#.#.#...#.#...#...#.....#...#...#...#####...#.#.#...#.....#...#.#...#.#...#.#.........#.#.#...#.#.#.......#\n" +
                "#.#####.#.#.#.#####.#####.#.#.###.#.#.#.###.#.#.#.#######.#########.#.#######.#.#.###.#####.#.###.###.#.###.#.#.#######.#.#.#.###.#.#.#####.#\n" +
                "#...#...#...#.....#.#.....#.#...#.#.#.#...#.#.#...#.......###...###.#...#.....#.#...#.#...#.#.###.#...#.#...#.#.......#...#.#...#.#...#.....#\n" +
                "###.#.###########.#.#.#####.###.#.#.#.###.#.#.#####.#########.#.###.###.#.#####.###.#.#.#.#.#.###.#.###.#.###.#######.#####.###.#.#####.#####\n" +
                "###...#...........#...#...#.....#...#.#...#.#.....#...#.....#.#.#...#...#.....#.#...#.#.#.#.#...#.#.#...#...#.#.......#...#.#...#.#.....#...#\n" +
                "#######.###############.#.###########.#.###.#####.###.#.###.#.#.#.###.#######.#.#.###.#.#.#.###.#.#.#.#####.#.#.#######.#.#.#.###.#.#####.#.#\n" +
                "#.....#.................#...........#.#...#.#...#...#.#.#...#.#.#...#.#...###.#.#...#.#.#.#.#...#.#.#...#...#.#.#...#...#...#.....#.......#.#\n" +
                "#.###.#############################.#.###.#.#.#.###.#.#.#.###.#.###.#.#.#.###.#.###.#.#.#.#.#.###.#.###.#.###.#.#.#.#.#####################.#\n" +
                "#...#.###...#...#.......#.....#.....#.#...#.#.#...#.#...#...#.#...#.#.#.#.#...#.#...#.#.#.#.#...#.#.....#.....#...#...#.....#...#...#...#...#\n" +
                "###.#.###.#.#.#.#.#####.#.###.#.#####.#.###.#.###.#.#######.#.###.#.#.#.#.#.###.#.###.#.#.#.###.#.#####################.###.#.#.#.#.#.#.#.###\n" +
                "#...#.....#...#.#.....#.#...#.#.....#.#.###...#...#.....#...#...#.#.#.#.#...###.#...#.#.#.#.#...#.#.....................###.#.#...#.#.#.#...#\n" +
                "#.#############.#####.#.###.#.#####.#.#.#######.#######.#.#####.#.#.#.#.#######.###.#.#.#.#.#.###.#.#######################.#.#####.#.#.###.#\n" +
                "#.#.......#...#...###.#.#...#...#...#...#...###...#.....#...#...#...#.#...#.....#...#.#.#.#.#...#.#.#.................#...#...#...#...#.#...#\n" +
                "#.#.#####.#.#.###.###.#.#.#####.#.#######.#.#####.#.#######.#.#######.###.#.#####.###.#.#.#.###.#.#.#.###############.#.#.#####.#.#####.#.###\n" +
                "#...#...#...#...#.....#.#.....#.#.........#.....#.#.....###.#.......#.....#.#...#...#...#.#.###...#.#.###...#...#...#...#.....#.#.....#...###\n" +
                "#####.#.#######.#######.#####.#.###############.#.#####.###.#######.#######.#.#.###.#####.#.#######.#.###.#.#.#.#.#.#########.#.#####.#######\n" +
                "###...#.....###.......#.......#...#...#...#...#.#...#...#...#.....#.......#.#.#...#...###.#.#.......#.#...#...#...#...........#.#.....#.....#\n" +
                "###.#######.#########.###########.#.#.#.#.#.#.#.###.#.###.###.###.#######.#.#.###.###.###.#.#.#######.#.#######################.#.#####.###.#\n" +
                "#...#.....#.#...#...#...........#.#.#...#...#...###.#.###...#...#.#...#...#.#.#...#...#...#.#...#.....#.....#...#...#.......###.#.#...#.#...#\n" +
                "#.###.###.#.#.#.#.#.###########.#.#.###############.#.#####.###.#.#.#.#.###.#.#.###.###.###.###.#.#########.#.#.#.#.#.#####.###.#.#.#.#.#.###\n" +
                "#.#...#...#...#...#.............#.#...........###...#.#.....#...#.#.#.#...#...#.#...###.....###...#...###...#.#.#.#.#.#.....#...#...#...#...#\n" +
                "#.#.###.#########################.###########.###.###.#.#####.###.#.#.###.#####.#.#################.#.###.###.#.#.#.#.#.#####.#############.#\n" +
                "#.#.#...#...#.....#...#.........#.#.....#...#...#...#.#.#...#.###.#.#.#...#.....#.......#...........#.#...###.#...#...#.....#...#.....#...#.#\n" +
                "#.#.#.###.#.#.###.#.#.#.#######.#.#.###.#.#.###.###.#.#.#.#.#.###.#.#.#.###.###########.#.###########.#.#####.#############.###.#.###.#.#.#.#\n" +
                "#...#.....#...###...#.#.#.......#...###...#.....###.#.#.#.#.#...#.#.#.#...#.....#...#...#...#.......#.#.......#.......#...#.....#.###...#...#\n" +
                "#####################.#.#.#########################.#.#.#.#.###.#.#.#.###.#####.#.#.#.#####.#.#####.#.#########.#####.#.#.#######.###########\n" +
                "#.........#.........#.#.#.#.............#...#.....#.#.#.#.#.#...#.#.#...#...#...#.#...#...#...#.....#.......#...###...#.#.#.......#.......###\n" +
                "#.#######.#.#######.#.#.#.#.###########.#.#.#.###.#.#.#.#.#.#.###.#.###.###.#.###.#####.#.#####.###########.#.#####.###.#.#.#######.#####.###\n" +
                "#...#...#...#...#...#...#...#...........#.#.#.#...#...#...#.#...#.#...#...#.#...#.....#.#...###.......#...#...#...#.#...#...#.......#...#...#\n" +
                "###.#.#.#####.#.#.###########.###########.#.#.#.###########.###.#.###.###.#.###.#####.#.###.#########.#.#.#####.#.#.#.#######.#######.#.###.#\n" +
                "###...#.#.....#.#.#...#...###.............#...#...#.......#...#.#.#...###...#...#.....#...#.#...#...#...#.......#.#.#...#.....#.......#.#...#\n" +
                "#######.#.#####.#.#.#.#.#.#######################.#.#####.###.#.#.#.#########.###.#######.#.#.#.#.#.#############.#.###.#.#####.#######.#.###\n" +
                "#.....#...#.....#.#.#.#.#.#...#.......#.....#...#...#...#...#...#.#...#...###.....#.......#...#...#.#...#.......#.#.....#.#...#.###...#...###\n" +
                "#.###.#####.#####.#.#.#.#.#.#.#.#####.#.###.#.#.#####.#.###.#####.###.#.#.#########.###############.#.#.#.#####.#.#######.#.#.#.###.#.#######\n" +
                "#.#...#...#.....#...#...#...#...#...#...###...#.......#.....###...#...#.#...###...#...............#...#.#.....#...#...#...#.#.#.....#...#...#\n" +
                "#.#.###.#.#####.#################.#.###########################.###.###.###.###.#.###############.#####.#####.#####.#.#.###.#.#########.#.#.#\n" +
                "#.#.#...#.#...#...#...#...........#.........#...###...........#.....###.#...#...#.................#...#.......#...#.#.#.#...#...........#.#.#\n" +
                "#.#.#.###.#.#.###.#.#.#.###################.#.#.###.#########.#########.#.###.#####################.#.#########.#.#.#.#.#.###############.#.#\n" +
                "#.#.#...#.#.#.#...#.#.#.#...................#.#.#...#...#...#.#.....#...#.....#...#...#...#.......#.#...........#...#...#.....###.........#.#\n" +
                "#.#.###.#.#.#.#.###.#.#.#.###################.#.#.###.#.#.#.#.#.###.#.#########.#.#.#.#.#.#.#####.#.#########################.###.#########.#\n" +
                "#.#.....#...#.#.....#...#...#...#...#...#...#.#.#.#...#...#...#.#...#.#.........#.#.#...#.#.###...#.#...........#...#...#.....#...#...#...#.#\n" +
                "#.###########.#############.#.#.#.#.#.#.#.#.#.#.#.#.###########.#.###.#.#########.#.#####.#.###.###.#.#########.#.#.#.#.#.#####.###.#.#.#.#.#\n" +
                "#.#.........#.#...........#...#...#...#...#...#...#...........#.#...#...#.........#.....#...#...#...#.........#...#.#.#.#.......#...#...#...#\n" +
                "#.#.#######.#.#.#########.###################################.#.###.#####.#############.#####.###.###########.#####.#.#.#########.###########\n" +
                "#.#.#.......#...#...#...#.....#...............#...#...#...#...#...#.#...#.......#.......###...#...#.........#.....#.#.#.#.....#...#...###...#\n" +
                "#.#.#.###########.#.#.#.#####.#.#############.#.#.#.#.#.#.#.#####.#.#.#.#######.#.#########.###.###.#######.#####.#.#.#.#.###.#.###.#.###.#.#\n" +
                "#...#.#.....#...#.#.#.#.....#.#...........###...#...#...#...#...#.#.#.#...###...#.....#.....#...#...#.....#.......#.#.#.#...#.#...#.#.#...#.#\n" +
                "#####.#.###.#.#.#.#.#.#####.#.###########.###################.#.#.#.#.###.###.#######.#.#####.###.###.###.#########.#.#.###.#.###.#.#.#.###.#\n" +
                "#.....#...#...#...#...#.....#.#...........#.....###...#...#...#.#.#.#...#...#.........#.....#...#.#...###.........#...#.#...#...#...#.#...#.#\n" +
                "#.#######.#############.#####.#.###########.###.###.#.#.#.#.###.#.#.###.###.###############.###.#.#.#############.#####.#.#####.#####.###.#.#\n" +
                "#...#.....###.....#...#.....#...#.........#...#...#.#.#.#.#.#...#.#.#...#...###.......#...#.....#...#...........#.....#.#...###.#...#.....#.#\n" +
                "###.#.#######.###.#.#.#####.#####.#######.###.###.#.#.#.#.#.#.###.#.#.###.#####.#####.#.#.###########.#########.#####.#.###.###.#.#.#######.#\n" +
                "#...#.###.....#...#.#.....#.......#...#...#...#...#.#...#...#.#...#.#...#.....#.#.....#S#.#.....#...#.........#.#.....#.....#...#.#.#.....#.#\n" +
                "#.###.###.#####.###.#####.#########.#.#.###.###.###.#########.#.###.###.#####.#.#.#######.#.###.#.#.#########.#.#.###########.###.#.#.###.#.#\n" +
                "#...#.#...#...#.....#...#...........#...###...#.###.#...#...#.#...#...#.#.....#.#...#####.#...#.#.#.#...#.....#...#.........#...#.#.#...#...#\n" +
                "###.#.#.###.#.#######.#.#####################.#.###.#.#.#.#.#.###.###.#.#.#####.###.#####.###.#.#.#.#.#.#.#########.#######.###.#.#.###.#####\n" +
                "###...#.....#...#...#.#.#...........###...#...#.....#.#...#.#.###...#...#...#...#...#####...#.#.#.#...#...###.......#.......###...#...#.....#\n" +
                "###############.#.#.#.#.#.#########.###.#.#.#########.#####.#.#####.#######.#.###.#########.#.#.#.###########.#######.###############.#####.#\n" +
                "#.......#...###...#...#...#...#...#.....#...#...#...#.....#...#.....#.......#.#...#####.....#.#.#...........#.#.......#...#####...###.......#\n" +
                "#.#####.#.#.###############.#.#.#.###########.#.#.#.#####.#####.#####.#######.#.#######.#####.#.###########.#.#.#######.#.#####.#.###########\n" +
                "#.....#.#.#.#.......#...#...#...#.......#...#.#...#.......#...#.....#.#...###.#...#####.......#.............#.#.###.....#...#...#...#.......#\n" +
                "#####.#.#.#.#.#####.#.#.#.#############.#.#.#.#############.#.#####.#.#.#.###.###.###########################.#.###.#######.#.#####.#.#####.#\n" +
                "###...#...#...#...#...#.#.............#.#.#.#.......#.......#.#...#.#.#.#.#...#...#######################E....#.....#.......#.#.....#.#.....#\n" +
                "###.###########.#.#####.#############.#.#.#.#######.#.#######.#.#.#.#.#.#.#.###.#####################################.#######.#.#####.#.#####\n" +
                "#...#...........#...#...#...#.........#...#.........#.#.......#.#...#.#.#.#.#...#.........#.....#.......#.......#.....###.....#.#...#.#.#...#\n" +
                "#.###.#############.#.###.#.#.#######################.#.#######.#####.#.#.#.#.###.#######.#.###.#.#####.#.#####.#.#######.#####.#.#.#.#.#.#.#\n" +
                "#...#.#.............#.#...#.#.......#...###.......###.#.......#.....#...#.#.#...#...#.....#...#.#.#...#...#.....#.........#.....#.#.#.#...#.#\n" +
                "###.#.#.#############.#.###.#######.#.#.###.#####.###.#######.#####.#####.#.###.###.#.#######.#.#.#.#.#####.###############.#####.#.#.#####.#\n" +
                "#...#.#.#...........#.#.#...###.....#.#.....#.....#...#.......###...#...#...#...#...#...#...#.#.#...#.....#.........#.....#.......#...#.....#\n" +
                "#.###.#.#.#########.#.#.#.#####.#####.#######.#####.###.#########.###.#.#####.###.#####.#.#.#.#.#########.#########.#.###.#############.#####\n" +
                "#...#.#...#.........#...#...#...#...#.......#.....#...#.#.......#...#.#.....#...#...#...#.#.#.#.###...###.........#.#.###...#...........#...#\n" +
                "###.#.#####.###############.#.###.#.#######.#####.###.#.#.#####.###.#.#####.###.###.#.###.#.#.#.###.#.###########.#.#.#####.#.###########.#.#\n" +
                "###...#...#...............#...#...#.#...#...#.....###.#.#.#.....###...#...#.#...#...#.....#.#.#.#...#.............#...#.....#.............#.#\n" +
                "#######.#.###############.#####.###.#.#.#.###.#######.#.#.#.###########.#.#.#.###.#########.#.#.#.#####################.###################.#\n" +
                "#...#...#...#...###.......#...#...#...#.#...#.#...#...#.#.#.#.....#...#.#.#.#...#.....#...#.#.#.#.#...#.....#...#.....#.....#.....#...#.....#\n" +
                "#.#.#.#####.#.#.###.#######.#.###.#####.###.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#####.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#####.#.###.#.#.#.#####\n" +
                "#.#.#.....#...#.....#...#...#.....#.....###.#.#.#.#.#...#.#.#.#...#.#.#.#.#...#.#...#.#.#...#.#.#...#...#...#.#.#.#...#...#.#...#.#.#.#.....#\n" +
                "#.#.#####.###########.#.#.#########.#######.#.#.#.#.#.###.#.#.#.###.#.#.#.###.#.#.#.#.#.#####.#.#########.###.#.#.#.###.#.#.###.#.#.#.#####.#\n" +
                "#.#...###.......#.....#.#.#.......#.#...#...#.#.#.#.#...#.#.#.#.#...#.#.#...#.#.#.#.#.#.....#.#...#...#...###.#...#.....#.#.....#...#.#...#.#\n" +
                "#.###.#########.#.#####.#.#.#####.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.###.#.#.#.#.#.#####.#.###.#.#.#.#####.###########.###########.#.#.#.#\n" +
                "#...#...........#.#.....#.#.....#...#.#...#...#.#.#.###.#.#.#.#.#...#...###...#.#.#.#.....#.#...#.#.#.#.#...#.#.....#...#.........#...#.#.#.#\n" +
                "###.#############.#.#####.#####.#####.#####.###.#.#.###.#.#.#.#.###.###########.#.#.#####.#.###.#.#.#.#.#.#.#.#.###.#.#.#########.#.###.#.#.#\n" +
                "###...#...........#.......#...#.#...#...#...#...#.#...#...#.#.#...#...#.........#.#.#...#.#...#.#...#.#...#...#...#.#.#.#...#...#.#.#...#.#.#\n" +
                "#####.#.###################.#.#.#.#.###.#.###.###.###.#####.#.###.###.#.#########.#.#.#.#.###.#.#####.###########.#.#.#.#.#.#.#.#.#.#.###.#.#\n" +
                "#.....#.#...................#...#.#...#.#...#...#...#.###...#...#...#.#.......#...#.#.#.#...#.#.#.....#.....#.....#...#.#.#.#.#.#.#.#...#...#\n" +
                "#.#####.#.#######################.###.#.###.###.###.#.###.#####.###.#.#######.#.###.#.#.###.#.#.#.#####.###.#.#########.#.#.#.#.#.#.###.#####\n" +
                "#.#.....#...#.....#...#...#...#...###.#...#...#.###.#.#...#...#...#.#.#.......#.###...#...#.#.#.#.#...#...#.#...#.....#...#...#...#...#.....#\n" +
                "#.#.#######.#.###.#.#.#.#.#.#.#.#####.###.###.#.###.#.#.###.#.###.#.#.#.#######.#########.#.#.#.#.#.#.###.#.###.#.###.###############.#####.#\n" +
                "#...###...#.#.#...#.#...#.#.#.#...#...#...###.#...#.#.#...#.#...#.#...#...#...#.........#.#.#.#.#.#.#...#.#.....#.#...###.......#...#.....#.#\n" +
                "#######.#.#.#.#.###.#####.#.#.###.#.###.#####.###.#.#.###.#.###.#.#######.#.#.#########.#.#.#.#.#.#.###.#.#######.#.#####.#####.#.#.#####.#.#\n" +
                "#.......#...#.#.#...###...#.#.#...#.#...#.....#...#...###.#.###.#.......#...#.#...#.....#...#...#.#.#...#...#...#.#.....#.#...#...#.....#.#.#\n" +
                "#.###########.#.#.#####.###.#.#.###.#.###.#####.#########.#.###.#######.#####.#.#.#.#############.#.#.#####.#.#.#.#####.#.#.#.#########.#.#.#\n" +
                "#.#...#...#...#...#.....#...#.#...#.#.#...#...#...#.......#...#...#...#.#.....#.#.#.......#...#...#.#.#...#...#...#...#...#.#.#.....#...#...#\n" +
                "#.#.#.#.#.#.#######.#####.###.###.#.#.#.###.#.###.#.#########.###.#.#.#.#.#####.#.#######.#.#.#.###.#.#.#.#########.#.#####.#.#.###.#.#######\n" +
                "#.#.#.#.#.#...#.....#...#...#...#.#...#.....#...#.#.....#...#...#.#.#...#.#...#.#...#...#...#.#...#.#.#.#.#...#.....#.#.....#...###.#.......#\n" +
                "#.#.#.#.#.###.#.#####.#.###.###.#.#############.#.#####.#.#.###.#.#.#####.#.#.#.###.#.#.#####.###.#.#.#.#.#.#.#.#####.#.###########.#######.#\n" +
                "#.#.#...#...#.#.......#.#...#...#.#.............#...#...#.#.#...#.#.#.....#.#.#...#.#.#.....#.#...#.#.#.#.#.#.#.....#.#...........#.........#\n" +
                "#.#.#######.#.#########.#.###.###.#.###############.#.###.#.#.###.#.#.#####.#.###.#.#.#####.#.#.###.#.#.#.#.#.#####.#.###########.###########\n" +
                "#.#...#...#.#.###...#...#...#.....#.#.....#...#...#.#...#.#.#.#...#.#.#...#.#...#.#...#.....#.#...#.#...#.#.#.......#.#...#.......#.........#\n" +
                "#.###.#.#.#.#.###.#.#.#####.#######.#.###.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#.###.#.#####.#####.###.#.#####.#.#########.#.#.#.#######.#######.#\n" +
                "#...#.#.#...#.#...#...#...#...#...#...###...#.#.#.#.#...#.#...#...#.#.#.#.#.#...#...###.....#.#...#.#.....#.........#...#...#...#...#.......#\n" +
                "###.#.#.#####.#.#######.#.###.#.#.###########.#.#.#.#.###.#######.#.#.#.#.#.#.#####.#######.#.#.###.#.#############.#########.#.#.###.#######\n" +
                "###...#.......#...#...#.#...#.#.#.#...........#.#.#.#...#.....###.#.#.#.#...#...#...#.....#.#.#.#...#.....#...#...#...#.......#...#...###...#\n" +
                "#################.#.#.#.###.#.#.#.#.###########.#.#.###.#####.###.#.#.#.#######.#.###.###.#.#.#.#.#######.#.#.#.#.###.#.###########.#####.#.#\n" +
                "#.....#...#.......#.#.#.#...#...#.#.......#...#.#.#...#.#.....#...#.#.#.....###...###...#...#.#...#...###.#.#...#...#...#...#.....#.#...#.#.#\n" +
                "#.###.#.#.#.#######.#.#.#.#######.#######.#.#.#.#.###.#.#.#####.###.#.#####.###########.#####.#####.#.###.#.#######.#####.#.#.###.#.#.#.#.#.#\n" +
                "#...#.#.#...#.....#.#.#.#...#...#.....#...#.#.#.#.#...#.#...###.#...#.#.....#.......#...#...#.#.....#.....#.......#.#...#.#...#...#...#...#.#\n" +
                "###.#.#.#####.###.#.#.#.###.#.#.#####.#.###.#.#.#.#.###.###.###.#.###.#.#####.#####.#.###.#.#.#.#################.#.#.#.#.#####.###########.#\n" +
                "#...#...#...#.#...#.#.#.###.#.#.#.....#...#.#...#.#...#...#.#...#.#...#.###...#.....#.....#.#.#.#.....#.....#.....#...#.#.#.....#...#...#...#\n" +
                "#.#######.#.#.#.###.#.#.###.#.#.#.#######.#.#####.###.###.#.#.###.#.###.###.###.###########.#.#.#.###.#.###.#.#########.#.#.#####.#.#.#.#.###\n" +
                "#...#...#.#.#.#...#.#.#...#.#.#.#.....#...#.#.....#...#...#.#...#.#...#.....#...#...........#.#.#.#...#...#.#.........#.#.#...#...#.#.#.#...#\n" +
                "###.#.#.#.#.#.###.#.#.###.#.#.#.#####.#.###.#.#####.###.###.###.#.###.#######.###.###########.#.#.#.#####.#.#########.#.#.###.#.###.#.#.###.#\n" +
                "###...#...#...###...#.....#...#.......#.....#.......###.....###...###.........###.............#...#.......#...........#...###...###...#.....#\n" +
                "#############################################################################################################################################";

        char[][] grid = parseGrid(input);

        System.out.println(cheat2(input));






    }
}
